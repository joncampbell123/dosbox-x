<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.21">
<title>Installing DOS 2.x-3.x in DOSBox-X</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="./rouge-github.css">
<link rel="stylesheet" href="./docinfo/copy-to-clipboard.css">
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="paragraph">
<p>Back to the <a href="Guide%3ADOS-Installation-in-DOSBoxâ€X">PC DOS and MS-DOS Installation Guide</a></p>
</div>
<div class="sect1">
<h2 id="_installing_dos_2_x_3_x_in_dosbox_x">Installing DOS 2.x-3.x in DOSBox-X</h2>
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_installing_dos_2_x_3_x_in_dosbox_x">Installing DOS 2.x-3.x in DOSBox-X</a></li>
<li><a href="#_overview">Overview</a>
<ul class="sectlevel2">
<li><a href="#_key_new_features_of_dos_2_00">Key new features of DOS 2.00</a></li>
<li><a href="#_key_new_features_of_dos_3_00">Key new features of DOS 3.00</a></li>
<li><a href="#_key_new_features_of_dos_3_10">Key new features of DOS 3.10</a></li>
<li><a href="#_key_new_features_of_dos_3_20">Key new features of DOS 3.20</a></li>
<li><a href="#_key_new_features_of_dos_3_21">Key new features of DOS 3.21</a></li>
<li><a href="#_key_new_features_of_dos_3_30">Key new features of DOS 3.30</a></li>
</ul>
</li>
<li><a href="#_this_guide_applies_to">This guide applies to</a></li>
<li><a href="#_external_links">External links</a></li>
<li><a href="#_notes">Notes</a></li>
<li><a href="#_creating_a_dos_2_0_3_21_hdd_image">Creating a DOS 2.0-3.21 HDD image</a></li>
<li><a href="#_creating_a_dos_3_3_hdd_image">Creating a DOS 3.3 HDD image</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_key_new_features_of_dos_2_00">Key new features of DOS 2.00</h3>
<div class="ulist">
<ul>
<li>
<p>First version to support HDDs (still using FAT12)</p>
</li>
<li>
<p>First version to support directories</p>
</li>
<li>
<p>First version to support redirection (pipes)</p>
</li>
<li>
<p>First version to support TSRs</p>
</li>
<li>
<p>First version to support installable device drivers</p>
</li>
<li>
<p>First version to introduce CONFIG.SYS</p>
</li>
<li>
<p>First to support 5.25" 9-sector 180KB (SSDD) and 360KB (DSDD) disks</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_key_new_features_of_dos_3_00">Key new features of DOS 3.00</h3>
<div class="ulist">
<ul>
<li>
<p>Maximum partition size of 32MB (using the new FAT16)</p>
</li>
<li>
<p>First version to support 5.25" 1.2MB disks (HD)</p>
</li>
<li>
<p>First version to support the AT internal clock</p>
</li>
<li>
<p>First version to support file locking and file redirection</p>
</li>
<li>
<p>First version to include SHARE.EXE, ATTRIB.EXE, KEYBxx.COM</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_key_new_features_of_dos_3_10">Key new features of DOS 3.10</h3>
<div class="ulist">
<ul>
<li>
<p>Add features for networking (e.g. IFS, remote file and print API)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_key_new_features_of_dos_3_20">Key new features of DOS 3.20</h3>
<div class="ulist">
<ul>
<li>
<p>First version to support 3.5" 720kB disks (2DD)</p>
</li>
<li>
<p>First version to support a phantom B: drive</p>
</li>
<li>
<p>First version to include REPLACE.EXE, XCOPY.EXE</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_key_new_features_of_dos_3_21">Key new features of DOS 3.21</h3>
<div class="ulist">
<ul>
<li>
<p>Bugfix release. Fixes the date not updating after midnight.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_key_new_features_of_dos_3_30">Key new features of DOS 3.30</h3>
<div class="ulist">
<ul>
<li>
<p>First version to support the MBR partitioning scheme with primary, extended and logical partitions</p>
</li>
<li>
<p>First version to support HDDs up to 504MB (partitions still limited to 32MB)</p>
</li>
<li>
<p>First version to support 3.5" 1.44MB disks (HD)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_this_guide_applies_to">This guide applies to</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
DOSBox-X is an IBM PC emulator, and as such the official IBM DOS and later packaged Microsoft DOS versions are the most compatible.
Many early IBM PC clone systems had various incompatibilities, and had custom OEM versions of DOS.
Since DOSBox-X does not emulate the peculiarities of such early clone systems, there OEM DOS versions are also not supported.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>IBM DOS editions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>IBM Personal Computer DOS 2.00</p>
</li>
<li>
<p>IBM Personal Computer DOS 2.10</p>
</li>
<li>
<p>IBM Personal Computer DOS 3.00</p>
<div class="ulist">
<ul>
<li>
<p>Included VDISK.SYS (RAM disk using extended memory)</p>
</li>
<li>
<p>Included SELECT.COM</p>
</li>
</ul>
</div>
</li>
<li>
<p>IBM Personal Computer DOS 3.10</p>
</li>
<li>
<p>IBM Personal Computer DOS 3.20</p>
<div class="ulist">
<ul>
<li>
<p>Removed LINK.EXE, EXE2BIN.EXE, BASIC sample programs</p>
</li>
<li>
<p>SELECT.COM enhanced with HDD support</p>
</li>
</ul>
</div>
</li>
<li>
<p>IBM Personal Computer DOS 3.30</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Microsoft DOS editions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Microsoft MS-DOS 3.21</p>
<div class="ulist">
<ul>
<li>
<p>First <em>packaged</em> MS-DOS product available to OEMs</p>
</li>
</ul>
</div>
</li>
<li>
<p>Microsoft MS-DOS 3.30</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_external_links">External links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.os2museum.com/wp/dos/dos-2-0-and-2-1/" class="bare">https://www.os2museum.com/wp/dos/dos-2-0-and-2-1/</a></p>
</li>
<li>
<p><a href="https://www.os2museum.com/wp/dos/dos-3-0-3-2/" class="bare">https://www.os2museum.com/wp/dos/dos-3-0-3-2/</a></p>
</li>
<li>
<p><a href="https://www.os2museum.com/wp/dos/dos-3-3/" class="bare">https://www.os2museum.com/wp/dos/dos-3-3/</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notes">Notes</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>For DOS 2.x, the maximum partition size depends on the OEM version, and should be 16 or 32MB using a FAT12 filesystem.</p>
</li>
<li>
<p>For DOS 3.00-3.21, the maximum partition size is supposed to be 32MB, using a FAT16 filesystem, but in reality this only appears to be the case for PC DOS 3.0 and 3.1. Other DOS versions are in practice limited to either 31MB, or their <code>FDISK</code> (or equivalent) tool is simply incompatible with DOSBox-X. For this reason the below examples will use 31MB for maximum compatibility between DOS versions.</p>
</li>
<li>
<p>While it is possible to use an HDD size larger than the maximum partition size, this is not recommended as these DOS versions only support a maximum of one DOS partition per HDD. In effect, you will not be able to access the additional capacity from DOS, and it is therefore waisted space. In addition, the <code>FDISK</code> option to use the entire fixed disk for DOS gets confused if the drive is larger than 32MB, and depending on the DOS version will either overflow such that a 40MB HDD image becomes a 40-32=8MB partition, or it will create a drive that cannot be formatted.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">DOS</th>
<th class="tableblock halign-left valign-top">OEM</th>
<th class="tableblock halign-left valign-top">Maximum partition size</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tandy 1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requires machine=tandy. Could read an HDD image created with PC DOS 2.10, but could not boot from it (after SYS), perhaps with HFORMAT which I could not easily locate&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zenith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incompatible disk preparation software</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 3.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compaq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incompatible FDISK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 3.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fails to boot from diskette, this can be circumvented by renaming CONFIG.SYS. FDISK hangs with 32MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 3.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will fail to boot with 32MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 3.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tandy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format error, and will fail to boot with 32MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS-DOS 3.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format error, and will fail to boot with 32MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC DOS 2.00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32MB</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC DOS 2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32MB</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC DOS 3.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32MB</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC DOS 3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32MB</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC DOS 3.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will fail to boot with 32MB</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>If you specify a different size then 31MB for the <code>IMGMAKE</code> command, pay close attention to the output of <code>IMGMAKE</code> as you will need to adjust the <code>IMGMOUNT</code> size parameter values accordingly.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>IMGMOUNT</code> size parameter should have the format of: <code>512,&lt;sectors&gt;,&lt;heads&gt;,&lt;cylinders&gt;</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_dos_2_0_3_21_hdd_image">Creating a DOS 2.0-3.21 HDD image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First you need to start DOSBox-X, and create an empty HDD image file.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Do not use the "Create blank disk image&#8230;&#8203;" option from the "DOS" menu in DOSBox-X to create a harddisk image.
It will create a partitioned and formatted harddisk image, which is incompatible with DOS versions prior to 5.0.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Until the partition is formatted, the use of a device number is necessary.
Device number 2 represents the first disk on the primary HDD controller.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go"> IMGMAKE hdd.img -t hd -size 31 -nofs
 IMGMOUNT 2 hdd.img -size 512,32,2,992 -fs none</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:PC-DOS_3.2_IMGMAKE.png" alt="Running IMGMAKE and IMGMOUNT commands">
</div>
</div>
<div class="paragraph">
<p>You are now ready to boot the DOS diskette image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go"> BOOT dos.img</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming that your uncompressed DOS 2.0-3.21 floppy image file is named dos.img and in your current working directory, it should boot DOS from the diskette image.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:PC-DOS_3.2_BOOT.png" alt="Booting PC DOS 3.2 from diskette">
</div>
</div>
<div class="paragraph">
<p>These early DOS versions did not have an installer, so the preparation of the harddisk and installation of DOS is a manual process.</p>
</div>
<div class="paragraph">
<p>You need to start with creating a DOS partition.</p>
</div>
<div class="paragraph">
<p>Run <code>FDISK</code> and select option 1 to create a new DOS partition, and confirm you want to use the entire fixed disk for DOS.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:PC-DOS_3.2_FDISK.png" alt="Running PC DOS 3.2 FDISK">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:PC-DOS_3.2_FDISK_Restart.png" alt="PC DOS 3.2 FDISK restart screen">
</div>
</div>
<div class="paragraph">
<p>After it is finished, press any key and DOS will reboot DOSBox-X, and you&#8217;re again at the DOSBox-X <code>Z:\&gt;</code> prompt.
At this point the HDD image is partitioned, but not yet formatted or made bootable, so that is what you need to do next.</p>
</div>
<div class="paragraph">
<p>Since there is now a partition, DOSBox-X can now autodetect the disk geometry. As such, it is no longer necessary to specify the geometry settings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go"> IMGMOUNT 2 hdd.img -fs none
 BOOT dos.img</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You have now again booted from the disk image, and are ready to format the C: drive and transfer the system files.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
As an IBM PC DOS exclusive, starting with PC DOS 3.0, there is the <code><a href="https://web.csulb.edu/~murdock/select.html">SELECT.COM</a></code> program which formats and transfers the OS from one diskette to another.
With PC DOS 3.2 this is enhanced to also support transfer to the HDD with the following syntax: <code>SELECT A: C: 1 US</code>. The options represent the source, destination, country code and keyboard code.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go"> FORMAT C: /S</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:PC-DOS_3.2_FORMAT.png" alt="Running PC DOS 3.2 FORMAT">
</div>
</div>
<div class="paragraph">
<p>You can optionally copy over the rest of the diskette contents at this point</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go"> MKDIR C:\DOS
 COPY A:\*.* C:\DOS</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also create a <code>AUTOEXEC.BAT</code> and <code>CONFIG.SYS</code> on the HDD with the included <code>EDLIN</code> editor.</p>
</div>
<div class="paragraph">
<p>From the DOSBox-X menu bar select Main and then select "Reset guest system".
You should be again at the DOSBox-X <code>Z:\&gt;</code> prompt.</p>
</div>
<div class="paragraph">
<p>Your setup is now complete and all that is left is how to boot the image normally.
From the DOSBox-X <code>Z:\&gt;</code> prompt this can be accomplished with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">IMGMOUNT C hdd.img
BOOT C:</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You probably don&#8217;t want to memorize those last two commands, so do yourself a favour and create yourself a DOSBox-X .conf config file and place those commands in the [autoexec] section of that file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You may notice that instead of using device number "2", we are now using drive "C". This is because the image is now partitioned and formatted and DOSBox-X is able to find the partition within it.
The advantage of being able to address it as "C" is that you can access the files inside the HDD image from the DOSBox-X integrated DOS, making it easier to transfer files.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:PC-DOS_3.2_BOOT_HDD.png" alt="PC DOS 3.2 Boot from HDD">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_dos_3_3_hdd_image">Creating a DOS 3.3 HDD image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creating a DOS 3.3 HDD image is nearly identical to that of DOS 3.0-3.2 above with a few notes</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DOS 3.3 introduced the MBR partitioning scheme with primary, extended and logical partitions, that was used for all later DOS versions.
However, DOSBox-X has only limited support for extended and logical partitions.
You can create them, and when you boot your DOS image, you can access them.
But when you <code>IMGMOUNT</code> the image in DOSBox-X, the integrated DOS will only be able to access the primary partition.</p>
</li>
<li>
<p>The maximum supported HDD size is now 504MB, but the maximum partition size is still only 32MB.
Since DOSBox-X has only limited support for extended and logical partitions, it is recommended that you only create a single primary partition up to 32MB per HDD image.
If you need multiple drives, you can create multiple images.</p>
</li>
<li>
<p>Partitioned and formatted images created with IMGMAKE are not recognised by DOS 3.3.
This is because IMGMAKE always sets the partition type to type 6 (FAT 16), while DOS 3.3 expects type 4 (FAT 16 &lt; 32M).
As such you need to use the -NOFS switch like with earlier DOS versions and manually create a DOS partition and format it.</p>
</li>
<li>
<p>After you have created your image, due to the newer style partition layout, which DOSBox-X can autodetect, you do not have to specify the geometry to mount the image.
So you can boot from the HDD image with the following commands instead.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">IMGMOUNT C hdd.img
BOOT C:</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MS-DOS:MS-DOS_3.3_BOOT_HDD.png" alt="MS-DOS 3.3 Boot from HDD">
</div>
</div>
</div>
</div>
</div>
<script src="./docinfo/copy-to-clipboard.js"></script>
</body>
</html>